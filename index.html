<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Banco de Horas</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header style="position: relative;">
            <img src="EngeLogo.png" alt="Logo" style="height: 35px; position: absolute; right: 0; top: 50%; transform: translateY(-50%);">
            <div style="text-align: center;">
                <h1 style="margin: 0;">Dashboard de Banco de Horas</h1>
                <p class="subtitle">An√°lise gerencial de horas trabalhadas</p>
            </div>
        </header>

        <!-- √Årea de Upload -->
        <section class="upload-section">
            <div class="upload-box" id="uploadBox">
                <input type="file" id="fileInput" accept=".xlsx, .xls" hidden>
                <div class="upload-content">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <h3>Arraste a planilha aqui</h3>
                    <p>ou clique para selecionar</p>
                    <span class="file-types">Formatos: .xlsx, .xls</span>
                </div>
            </div>
            <div id="fileName" class="file-name"></div>
            <button id="changeFileBtn" class="change-file-btn" style="display: none;">üì§ Trocar Planilha</button>
        </section>

        <!-- Cards de Resumo -->
        <section class="summary-cards" id="summaryCards" style="display: none;">
            <div class="card">
                <div class="card-icon">üë•</div>
                <div class="card-content">
                    <h3>Total de Funcion√°rios</h3>
                    <p class="card-value" id="totalEmployees">0</p>
                </div>
            </div>
            <div class="card">
                <div class="card-icon">‚è±Ô∏è</div>
                <div class="card-content">
                    <h3>Saldo Total</h3>
                    <p class="card-value" id="totalHours">0h</p>
                </div>
            </div>
            <div class="card positive">
                <div class="card-icon">‚úÖ</div>
                <div class="card-content">
                    <h3>Saldo Positivo</h3>
                    <p class="card-value" id="positiveHours">0h</p>
                </div>
            </div>
            <div class="card negative">
                <div class="card-icon">‚ö†Ô∏è</div>
                <div class="card-content">
                    <h3>Saldo Negativo</h3>
                    <p class="card-value" id="negativeHours">0h</p>
                </div>
            </div>
        </section>

        <!-- Gr√°ficos -->
        <section class="charts-section" id="chartsSection" style="display: none;">
            <div class="chart-container">
                <h3>Distribui√ß√£o de Horas por Funcion√°rio</h3>
                <canvas id="employeeChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>Evolu√ß√£o Mensal</h3>
                <canvas id="monthlyChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>Status do Banco de Horas</h3>
                <canvas id="statusChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>Top 10 - Maiores Saldos</h3>
                <canvas id="topEmployeesChart"></canvas>
            </div>
        </section>

        <!-- Tabela Detalhada -->
        <section class="table-section" id="tableSection" style="display: none;">
            <h3>Detalhamento por Funcion√°rio</h3>
            <div class="table-controls">
                <input type="text" id="searchInput" placeholder="Buscar funcion√°rio...">
                <select id="filterSelect">
                    <option value="all">Todos</option>
                    <option value="positive">Saldo Positivo</option>
                    <option value="negative">Saldo Negativo</option>
                    <option value="zero">Saldo Zero</option>
                </select>
            </div>
            <div class="table-wrapper">
                <table id="employeeTable">
                    <thead>
                        <tr>
                            <th>Funcion√°rio</th>
                            <th>Matr√≠cula</th>
                            <th>Departamento</th>
                            <th>Total Cr√©dito</th>
                            <th>Total D√©bito</th>
                            <th>Saldo</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Instru√ß√µes -->
        <section class="instructions" id="instructions">
            <h3>üìã Formato da Planilha</h3>
            <p><strong>Estrutura esperada:</strong></p>
            <ul>
                <li>üìÇ <strong>Cada aba = 1 funcion√°rio</strong> (nome da aba √© o primeiro nome)</li>
                <li>üìä Dentro de cada aba:
                    <ul style="margin-top: 10px;">
                        <li><strong>MAT</strong>: Matr√≠cula do funcion√°rio</li>
                        <li><strong>NOME</strong>: Nome completo</li>
                        <li><strong>CR√âDITO</strong>: Horas creditadas (formato HH:MM:SS)</li>
                        <li><strong>D√âBITO</strong>: Horas debitadas (formato HH:MM:SS)</li>
                        <li><strong>M√äS</strong>: Per√≠odo (ex: M√äS 05/2025)</li>
                        <li>Linha com <strong>"POSITIVO"</strong> + total de cr√©ditos</li>
                        <li>Linha com <strong>"NEGATIVO"</strong> + total de d√©bitos</li>
                        <li>Linha com <strong>"TOTAL"</strong> + saldo final</li>
                    </ul>
                </li>
            </ul>
            <p class="note">üí° O sistema l√™ os totais POSITIVO e NEGATIVO j√° calculados na planilha e usa o nome completo da coluna NOME.</p>
            <p class="note">‚ö†Ô∏è Abas com nomes: SINDICATO, RELAT√ìRIO, MODELO, TEMPLATE ser√£o ignoradas automaticamente.</p>
        </section>
    </div>

    <script src="js/script.js"></script>
</body>
</html>
